# Code.gs 실행 가이드

## Google Apps Script에서 함수 실행하는 방법

### 1단계: Google Sheets에서 Apps Script 열기

1. Google Sheets 파일을 엽니다
2. 상단 메뉴에서 **확장 프로그램** > **Apps Script** 클릭
3. 새 탭에서 Apps Script 편집기가 열립니다

### 2단계: Code.gs 파일 확인

1. 왼쪽 파일 목록에서 `Code.gs` 파일이 있는지 확인
2. 없으면 `+` 버튼을 클릭하여 새 파일 생성
3. `Code.gs` 파일의 내용을 복사하여 붙여넣기

### 3단계: 함수 선택 및 실행

#### 방법 1: 함수 드롭다운에서 선택

1. 편집기 상단에 **함수 선택** 드롭다운이 있습니다
2. 드롭다운을 클릭하면 사용 가능한 함수 목록이 표시됩니다
3. `createFormAutomatically` 함수를 선택합니다
4. 선택 후 **실행** 버튼(▶️)을 클릭합니다

#### 방법 2: 직접 함수 이름 입력

1. 함수 선택 드롭다운 옆에 있는 입력란에 `createFormAutomatically` 입력
2. **실행** 버튼(▶️)을 클릭합니다

### 4단계: 권한 승인 (최초 1회만)

1. 처음 실행하면 Google 계정 권한 승인 화면이 나타납니다
2. **권한 검토** 버튼 클릭
3. Google 계정 선택
4. **고급** > **안전하지 않은 페이지로 이동** 클릭 (필요시)
5. **허용** 버튼 클릭하여 권한 승인

### 5단계: 실행 로그 확인

1. 실행 후 하단에 **실행 로그**가 표시됩니다
2. 로그에서 다음 정보를 확인할 수 있습니다:
   - 설문지 생성 완료 메시지
   - 생성된 설문지 URL
   - 설문지 ID (FORM_ID)

### 6단계: FORM_ID 업데이트

1. 실행 로그에서 `FORM_ID`를 복사합니다
2. `Code.gs` 파일 상단의 다음 부분을 찾습니다:
   ```javascript
   const FORM_ID = 'YOUR_FORM_ID';
   ```
3. `YOUR_FORM_ID`를 복사한 ID로 교체합니다:
   ```javascript
   const FORM_ID = '1eRxOqxEI3F62HSUbdE2JRbDjKkbDEuQFgB2DynyhjZ4';
   ```
4. 저장 (Ctrl+S 또는 Cmd+S)

## 실행 가능한 주요 함수들

### 1. `createFormAutomatically`
- **용도**: 참가자 명단을 기반으로 설문지 자동 생성
- **실행 시점**: 설문지를 처음 만들 때
- **결과**: 새 Google Forms 설문지 생성

### 2. `initializeSheets`
- **용도**: 필요한 시트들을 자동으로 생성
- **실행 시점**: 처음 설정할 때
- **결과**: 참가자명단, 설문응답, 점수계산, 요약 시트 생성

### 3. `calculateScores`
- **용도**: 점수 재계산
- **실행 시점**: 점수가 제대로 계산되지 않을 때 수동 실행
- **결과**: 점수계산 시트 업데이트

### 4. `reprocessAllResponses`
- **용도**: 모든 설문 응답을 다시 처리
- **실행 시점**: 응답 처리에 문제가 있을 때
- **결과**: 모든 응답 데이터 재처리

## 실행 화면 예시

```
[함수 선택 ▼] [createFormAutomatically] [▶️ 실행]

실행 로그:
설문지 생성 완료!
URL: https://docs.google.com/forms/d/1eRxOqxEI3F62HSUbdE2JRbDjKkbDEuQFgB2DynyhjZ4/edit
ID: 1eRxOqxEI3F62HSUbdE2JRbDjKkbDEuQFgB2DynyhjZ4

중요: Code.gs 파일의 FORM_ID를 다음으로 업데이트하세요: 1eRxOqxEI3F62HSUbdE2JRbDjKkbDEuQFgB2DynyhjZ4
```

## 주의사항

1. **참가자 명단 필수**: `createFormAutomatically` 실행 전에 반드시 참가자 명단을 입력해야 합니다
2. **SPREADSHEET_ID 설정**: Code.gs 상단의 `SPREADSHEET_ID`도 반드시 설정해야 합니다
3. **권한 승인**: 처음 실행 시 Google 계정 권한 승인이 필요합니다
4. **실행 시간**: 설문지 생성에는 몇 초에서 수십 초가 걸릴 수 있습니다

## 문제 해결

### 함수가 보이지 않는 경우
- Code.gs 파일이 제대로 저장되었는지 확인
- 페이지를 새로고침 (F5)

### 권한 오류가 발생하는 경우
- Google 계정으로 로그인되어 있는지 확인
- Apps Script 프로젝트의 권한 설정 확인

### "Cannot read properties of null" 오류가 발생하는 경우
이 오류는 시트가 없을 때 발생합니다. 다음 순서로 해결하세요:

1. **먼저 `initializeSheets` 함수 실행**
   - 함수 선택 드롭다운에서 `initializeSheets` 선택
   - 실행 버튼 클릭
   - 시트가 생성되었는지 확인

2. **참가자 명단 입력**
   - Google Sheets로 돌아가기
   - "참가자명단" 시트 열기
   - 이름과 팀명 입력

3. **다시 `createFormAutomatically` 실행**

### "참가자 명단이 비어있습니다" 오류
- "참가자명단" 시트에 데이터가 있는지 확인
- 이름과 팀명이 제대로 입력되었는지 확인

### "SPREADSHEET_ID를 먼저 설정해주세요" 오류
- Code.gs 파일 상단의 `SPREADSHEET_ID` 값을 확인
- Google Sheets URL에서 ID를 복사하여 설정

### 설문지가 생성되지 않는 경우
- 실행 로그에서 오류 메시지 확인
- 참가자 명단이 제대로 입력되었는지 확인
- SPREADSHEET_ID가 올바른지 확인
